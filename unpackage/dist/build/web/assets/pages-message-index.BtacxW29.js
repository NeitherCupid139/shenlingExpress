import{a as e,c as a,w as t,z as s,b as l,g as i,f as r,t as n,A as d,p as c,y as o,h as u,i as _,r as f,o as p,q as g,d as m,F as h,e as v,j as y,S as k,m as x,n as b,v as w,x as S}from"./index-BIIXmq18.js";import{_ as C}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{r as j}from"./uni-app.es.DHhZJsCJ.js";import{u as F}from"./uni-fetch.BLhei1mW.js";import{_ as T,a as $}from"./uni-list.-t36oq1I.js";const I=C({name:"UniCard",emits:["click"],props:{title:{type:String,default:""},subTitle:{type:String,default:""},padding:{type:String,default:"10px"},margin:{type:String,default:"15px"},spacing:{type:String,default:"0 10px"},extra:{type:String,default:""},cover:{type:String,default:""},thumbnail:{type:String,default:""},isFull:{type:Boolean,default:!1},isShadow:{type:Boolean,default:!0},shadow:{type:String,default:"0px 0px 3px 1px rgba(0, 0, 0, 0.08)"},border:{type:Boolean,default:!0}},methods:{onClick(e){this.$emit("click",e)}}},[["render",function(f,p,g,m,h,v){const y=o,k=u,x=_;return e(),a(k,{class:c(["uni-card",{"uni-card--full":g.isFull,"uni-card--shadow":g.isShadow,"uni-card--border":g.border}]),style:d({margin:g.isFull?0:g.margin,padding:g.spacing,"box-shadow":g.isShadow?g.shadow:""})},{default:t((()=>[s(f.$slots,"cover",{},(()=>[g.cover?(e(),a(k,{key:0,class:"uni-card__cover"},{default:t((()=>[l(y,{class:"uni-card__cover-image",mode:"widthFix",onClick:p[0]||(p[0]=e=>v.onClick("cover")),src:g.cover},null,8,["src"])])),_:1})):i("",!0)]),!0),s(f.$slots,"title",{},(()=>[g.title||g.extra?(e(),a(k,{key:0,class:"uni-card__header"},{default:t((()=>[l(k,{class:"uni-card__header-box",onClick:p[1]||(p[1]=e=>v.onClick("title"))},{default:t((()=>[g.thumbnail?(e(),a(k,{key:0,class:"uni-card__header-avatar"},{default:t((()=>[l(y,{class:"uni-card__header-avatar-image",src:g.thumbnail,mode:"aspectFit"},null,8,["src"])])),_:1})):i("",!0),l(k,{class:"uni-card__header-content"},{default:t((()=>[l(x,{class:"uni-card__header-content-title uni-ellipsis"},{default:t((()=>[r(n(g.title),1)])),_:1}),g.title&&g.subTitle?(e(),a(x,{key:0,class:"uni-card__header-content-subtitle uni-ellipsis"},{default:t((()=>[r(n(g.subTitle),1)])),_:1})):i("",!0)])),_:1})])),_:1}),l(k,{class:"uni-card__header-extra",onClick:p[2]||(p[2]=e=>v.onClick("extra"))},{default:t((()=>[l(x,{class:"uni-card__header-extra-text"},{default:t((()=>[r(n(g.extra),1)])),_:1})])),_:1})])),_:1})):i("",!0)]),!0),l(k,{class:"uni-card__content",style:d({padding:g.padding}),onClick:p[3]||(p[3]=e=>v.onClick("content"))},{default:t((()=>[s(f.$slots,"default",{},void 0,!0)])),_:3},8,["style"]),l(k,{class:"uni-card__actions",onClick:p[4]||(p[4]=e=>v.onClick("actions"))},{default:t((()=>[s(f.$slots,"actions",{},void 0,!0)])),_:3})])),_:3},8,["class","style"])}],["__scopeId","data-v-64011453"]]),B={list:(e=201,a=1,t=10)=>F.get("/driver/messages/page",{contentType:e,page:a,pageSize:t})},q=C({__name:"notify",setup(s){const d=f([]),c=f(!1);let o=1;async function x(){o++;let e=await B.list(201,o,10);e.data.data.items&&(d.value.push(...e.data.data.items),console.log("已经触底...",o))}async function b(){console.log("下拉刷新触发..."),c.value=!0,o=1;let e=await B.list(201,o,10);d.value=e.data.data.items,c.value=!1}return p((async()=>{let e=await B.list();d.value=e.data.data.items})),(s,o)=>{const f=_,p=u,w=y,S=j(g("uni-card"),I),C=k;return e(),a(C,{class:"scroll-view","scroll-y":"",onScrolltolower:x,"refresher-enabled":"",onRefresherrefresh:b,"refresher-triggered":c.value},{default:t((()=>[l(p,{class:"scroll-view-wrapper"},{default:t((()=>[l(p,{class:"message-action"},{default:t((()=>[l(f,{class:"iconfont icon-clear"}),r(" 全部已读 ")])),_:1}),(e(!0),m(h,null,v(d.value,(s=>(e(),a(S,{border:!1,"is-shadow":!1,key:s.id},{title:t((()=>[l(p,{class:"title unread"},{default:t((()=>[r(n(s.title),1)])),_:2},1024)])),default:t((()=>[l(p,{class:"brief"},{default:t((()=>[r(n(s.content),1)])),_:2},1024),l(p,{class:"extra"},{default:t((()=>[l(f,{class:"time"},{default:t((()=>[r(n(s.created),1)])),_:2},1024),l(w,{"hover-class":"none",class:"link",url:"/subpkg_message/content/index"},{default:t((()=>[r("查看详情")])),_:1})])),_:2},1024)])),_:2},1024)))),128)),i("",!0)])),_:1})])),_:1},8,["refresher-triggered"])}}},[["__scopeId","data-v-00a9379a"]]),z=C({__name:"announce",setup(s){const i=f([]);return p((async()=>{let e=await B.list(200);i.value=e.data.data.items})),(s,n)=>{const d=_,c=u,o=j(g("uni-list-item"),T),f=j(g("uni-list"),$),p=k;return e(),a(p,{class:"scroll-view","refresher-enabled":"","scroll-y":""},{default:t((()=>[l(c,{class:"scroll-view-wrapper"},{default:t((()=>[l(c,{class:"message-action"},{default:t((()=>[l(d,{class:"iconfont icon-clear"}),r(" 全部已读 ")])),_:1}),l(f,{border:!1},{default:t((()=>[(e(!0),m(h,null,v(i.value,(s=>(e(),a(o,{key:s.id,to:"/subpkg_message/content/index",ellipsis:"1",title:s.title,rightText:s.created},{header:t((()=>[l(d,{class:"dot"})])),_:2},1032,["title","rightText"])))),128))])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-4ce0d7a6"]]),A=C({__name:"index",setup(s){const d=f(0),o=x([{title:"任务通知",rendered:!0},{title:"公告",rendered:!1}]);return(s,f)=>{const p=_,g=u;return e(),a(g,{class:"page-container"},{default:t((()=>[l(g,{class:"message-tabbar"},{default:t((()=>[(e(!0),m(h,null,v(o,((s,l)=>(e(),a(p,{key:s.title,onClick:e=>function(e){o[e].rendered=!0,d.value=e}(l),class:c([{active:d.value===l},"tab"])},{default:t((()=>[r(n(s.title),1)])),_:2},1032,["onClick","class"])))),128))])),_:1}),o[0].rendered?b((e(),a(g,{key:0,class:"message-list"},{default:t((()=>[l(S(q))])),_:1},512)),[[w,0===d.value]]):i("",!0),o[1].rendered?b((e(),a(g,{key:1,class:"message-list"},{default:t((()=>[l(S(z))])),_:1},512)),[[w,1===d.value]]):i("",!0)])),_:1})}}},[["__scopeId","data-v-a4eed5e8"]]);export{A as default};
