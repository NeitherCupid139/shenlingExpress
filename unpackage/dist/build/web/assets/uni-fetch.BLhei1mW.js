import{a5 as e,a6 as t,a7 as n,B as s,r,a8 as i}from"./index-BIIXmq18.js";var a={};Object.defineProperty(a,"__esModule",{value:!0});var o=a.createUniFetch=void 0;function u(s){var r,i;const a=[],o=s=>(!s.url.startsWith("http")&&o.baseURL&&(s.url=o.baseURL+s.url),o.intercept.request(s),(null==o?void 0:o.loading)&&!a.length&&e(Object.assign({},o.loading)),a.push("loading"),new Promise(((e,r)=>{t(Object.assign(Object.assign({},s),{success:t=>{e(o.intercept.response(Object.assign(Object.assign({},t),{config:s})))},fail:r,complete:()=>{a.pop(),a.length||n()}}))})));return o.loading=null==s?void 0:s.loading,o.baseURL=null==s?void 0:s.baseURL,o.intercept={request:e=>e,response:e=>e},(null===(r=null==s?void 0:s.intercept)||void 0===r?void 0:r.request)&&(o.intercept.request=s.intercept.request),(null===(i=null==s?void 0:s.intercept)||void 0===i?void 0:i.response)&&(o.intercept.response=s.intercept.response),o.get=function(e,t={}){return o({url:e,method:"GET",data:t})},o.post=function(e,t={}){return o({url:e,method:"POST",data:t})},o.put=function(e,t={}){return o({url:e,method:"PUT",data:t})},o.delete=function(e,t){return o({url:e,method:"DELETE",data:t})},o}o=a.createUniFetch=u,a.default=u();const l=s("user",(()=>({token:r("")})),{persist:{paths:["token"]}}),c=o({loading:{title:"正在加载中..."},baseURL:"https://slwl-api.itheima.net",intercept:{request(e){const t={Authorization:l().token};return e.header=Object.assign({},t,e.header),e},response:e=>(401===e.statusCode&&(uni.utils.toast("登录失效，请重新登录"),i({url:"/pages/login/index"})),e)}});export{l as a,c as u};
